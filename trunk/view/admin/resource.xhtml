<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
    xmlns:s="http://jboss.com/products/seam/taglib"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:rich="http://richfaces.org/rich"
    template="/layout/template.xhtml">

<ui:define name="title"> Ресурс #{resourcesHome.instance.name}</ui:define>

<ui:define name="body">

        <h1>#{resourcesHome.instance.name} (#{resourcesHome.instance.type})</h1>

        <s:decorate id="owner" template="/layout/display.xhtml">
            <ui:define name="label">Владелец:</ui:define>
            <h:outputText value="#{resourcesHome.instance.owner.name}"/>
        </s:decorate>


        <s:decorate id="name" template="/layout/display.xhtml">
            <ui:define name="label">Имя:</ui:define>
            <h:outputText value="#{resourcesHome.instance.name}"/>
        </s:decorate>

        <s:decorate id="type" template="/layout/display.xhtml">
            <ui:define name="label">Тип:</ui:define>
            <h:outputText value="#{resourcesHome.instance.type}"/>
        </s:decorate>




        <div style="clear:both" />
    <br/>
         <h:form>

             <rich:tabPanel switchType="client">

                 <rich:tab label="Остатки">
         <rich:dataTable value="#{resourcesHome.instance.contents}" var="remain" width="600px" rows="25" id="remainsTable"
                 onRowMouseOver="this.style.backgroundColor='#F1F1F1'" onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'">
             <rich:column sortBy="#{remain.product.ASIN}" width="80px">
                 <f:facet name="header">
                     Артикул
                 </f:facet>
                 #{remain.product.ASIN}
             </rich:column>
             <rich:column sortBy="#{remain.product.title}" width="300px">
                 <f:facet name="header">
                     Товар
                 </f:facet>
                 #{remain.product.title}
             </rich:column>
             <rich:column sortBy="#{remain.quantity}" styleClass="rich-table-number-cell" width="80px" headerClass="rich-table-number-cell">
                 <f:facet name="header">
                     Остаток
                 </f:facet>
                 #{remain.quantity}
             </rich:column>

             <rich:column></rich:column>

             <f:facet name="footer">
                 <rich:columnGroup>
                     <rich:column>Всего</rich:column>
                     <rich:column>#{resourcesHome.instance.contents.size} наименований</rich:column>
                     <rich:column styleClass="rich-table-number-cell"><h:outputText value="#{resourcesHome.instance.total}"><f:convertNumber type="currency" currencySymbol="" /></h:outputText> шт.</rich:column>
                     <rich:column></rich:column>
                 </rich:columnGroup>
             </f:facet>

         </rich:dataTable>

        <div style="clear:both" />
        

    <br/><br/>
    <div class="actionButtons">

        <s:button view="/admin/resourceEdit.xhtml"
                    id="edit"
                 value="Изменить"/>

        <s:button view="/admin/#{empty resourceFrom ? 'resourcesList' : resourceFrom}.xhtml"
                    id="done"
                 value="Назад"/>

        <s:button view="/admin/shipmentEdit.xhtml"
                  action="#{editShipment.create()}"
                  id="newShipment"
                  value="Создать Перемещение">
            <f:param name="fromResourceId" value="#{resourcesHome.instance.id}"/>
         </s:button>

    </div>
                 </rich:tab>

                 <rich:tab label="Перемещения">


                     <rich:dataTable title="Перемещения" value="#{shipmentsHome.shipmentsForResource(resourcesHome.instance)}" var="shipment" width="600px" rows="25" id="shipmentsTable"
                 onRowMouseOver="this.style.backgroundColor='#F1F1F1'" onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'">>
                         <rich:column label="№" width="30px" sortBy="#{shipment.id}">
                             <f:facet name="header">№</f:facet>
                             #{shipment.id}
                         </rich:column>

                         <rich:column label="Дата" width="80px" sortBy="#{shipment.date}">
                             <f:facet name="header">Дата</f:facet>
                             <h:outputText value="#{shipment.date}">
                             </h:outputText>
                         </rich:column>


                         <rich:column width="200px" sortBy="#{shipment.from}">
                             <f:facet name="header">Откуда</f:facet>
                              <s:link view="/admin/resource.xhtml"
                            value="#{shipment.from.name}"
                            propagation="none"
                            id="from">
                                 <f:param name="id"  value="#{shipment.from.id}"/>
                             </s:link>

                         </rich:column>

                         <rich:column width="200px" sortBy="#{shipment.to}">
                             <f:facet name="header">Куда</f:facet>
                             <s:link view="/admin/resource.xhtml"
                           value="#{shipment.to.name}"
                           propagation="none"
                           id="to">
                                <f:param name="id"  value="#{shipment.to.id}"/>
                            </s:link>
                         </rich:column>

                         <rich:column width="80px" sortBy="#{shipment.total}">
                             <f:facet name="header">Кол-во</f:facet>
                             #{shipment.total}
                         </rich:column>
                         
                         <rich:column></rich:column>

                     </rich:dataTable>

                     
                 </rich:tab>


</rich:tabPanel>

         </h:form>


</ui:define>

</ui:composition>
