<?xml version="1.0"?>
<pageflow-definition
	xmlns="http://jboss.com/products/seam/pageflow"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation=
	    "http://jboss.com/products/seam/pageflow http://jboss.org/products/seam/pageflow-2.2.xsd"
 	name="processorder">
    <start-state name="start">
        <transition to="assemble"/>
    </start-state>


    <page name="assemble" view-id="/order/assemble.xhtml"
            no-conversation-view-id="/order/accept.xhtml">
        <redirect />
        <transition name="assemble" to="export">
            <action expression="#{processOrder.assemble}" />
        </transition>
    </page>

    <page name="export" view-id="/order/export.xhtml">
        <redirect />
        <transition name="export" to="send">
            <action expression="#{processOrder.export}" />
        </transition>
    </page>

    <page view-id="/order/send.xhtml" name="send">
        <redirect />
        <transition name="send" to="notify">
            <action expression="#{processOrder.send}" />
        </transition>
    </page>

    <page view-id="/order/notify.xhtml" name="notify">
        <redirect />
        <transition name="notify" to="getpaid">
            <action expression="#{processOrder.notifyReceiver}" />
        </transition>
    </page>

    <page view-id="/order/getpaid.xhtml" name="getpaid">
        <redirect />
        <transition name="getpaid" to="archive">
            <action expression="#{processOrder.getPaid}" />
        </transition>
    </page>

    <page view-id="/order/archive.xhtml" name="archive">
        <redirect />
        <transition name="archive" to="complete">
            <action expression="#{processOrder.archive}" />
        </transition>
    </page>


    <page view-id="/order/complete.xhtml" name="complete">
        <end-conversation />
        <redirect />
    </page>

    <page name="cancel" view-id="/order/accept.xhtml">
	    <end-conversation before-redirect="true"/>
        <redirect/>
    </page>


    <end-state name="finish" />
</pageflow-definition>